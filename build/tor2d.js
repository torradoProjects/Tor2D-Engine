/*
TOR2D-js 2.0.2 by @TorradoProjects 
https://torradoprojects.github.io/site/
Licencia MIT

Derechos de autor (c) [2024] [TorradoProjects]

Por la presente se concede permiso, de forma gratuita, a cualquier persona que obtenga una copia
de este software y de los archivos de documentación asociados (el "Software"), para tratar
en el Software sin restricción, incluyendo sin limitación los derechos de usar, copiar,
modificar, fusionar, publicar, distribuir, sublicenciar y/o vender copias del Software, y para
permitir a las personas a quienes se les proporcione el Software a hacer lo mismo, sujeto a las siguientes condiciones:

El aviso de derechos de autor anterior y este aviso de permiso deberán incluirse en todas las
copias o partes sustanciales del Software.

EL SOFTWARE SE PROPORCIONA "TAL CUAL", SIN GARANTÍA DE NINGÚN TIPO, EXPRESA O IMPLÍCITA,
INCLUYENDO PERO NO LIMITADO A LAS GARANTÍAS DE COMERCIABILIDAD, IDONEIDAD PARA UN PROPÓSITO
PARTICULAR Y NO INFRACCIÓN. EN NINGÚN CASO LOS AUTORES O TITULARES DE LOS DERECHOS DE AUTOR
SERÁN RESPONSABLES DE NINGUNA RECLAMACIÓN, DAÑO U OTRA RESPONSABILIDAD, YA SEA EN UNA ACCIÓN
DE CONTRATO, AGRAVIO O DE OTRO MODO, QUE SURJA DE, FUERA O EN CONEXIÓN CON EL SOFTWARE O SU
USO U OTRO TIPO DE ACCIONES EN EL SOFTWARE.
*/
(()=>{"use strict";var i={d:(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},o:(i,t)=>Object.prototype.hasOwnProperty.call(i,t),r:i=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})}},t={};i.r(t),i.d(t,{AnimatedSprite:()=>V,AudioPlayer:()=>K,BaseButton:()=>O,BoxCollider:()=>Q,Button:()=>j,Camera:()=>m,Collision:()=>M,GameObject:()=>U,Input:()=>C,Joystick:()=>k,Label:()=>B,ParallaxBackground:()=>G,ParallaxLayer:()=>J,Particle:()=>Z,ParticleSystem:()=>H,RenderShape:()=>X,SpatialGrid:()=>I,Sprite:()=>W,SpriteSheet:()=>q,TOR2D:()=>L,Text:()=>Y,Texture:()=>N,TextureButton:()=>F,Time:()=>T,Timer:()=>D,UI:()=>$,Vector2:()=>e,_object:()=>A,add_in_grid:()=>E,collisions:()=>u,deleteAllData:()=>_,deleteData:()=>b,event:()=>f,isVisible:()=>g,lerp:()=>z,loadData:()=>v,max:()=>P,min:()=>R,pause_scene:()=>x,print:()=>y,random:()=>S,saveData:()=>w});class e{constructor(i=0,t=0){this.x=i,this.y=t}add(i){return new e(this.x+i.x,this.y+i.y)}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){let i=this.length();return 0!==i?this.split(i):new e(0,0)}multiply(i){return new e(this.x*i,this.y*i)}split(i){return new e(this.x/i,this.y/i)}subtract(i){return new e(this.x-i.x,this.y-i.y)}}let s=[],o=null,n=null,r=null,h=null,a=null,l=null,c=null,d=!1,p=null,u=[],m={position:new e(0,0),canvas:h,target:void 0,followSpeed:.05,boundaryX:0,boundaryY:0,zoomLevel:1,child:[],moveX:0,moveY:0,follow:function(i,t,e){this.target!==i&&(this.boundaryX=t<=100?t:100,this.boundaryY=e<=100?e:100,this.target=i)},applyTransformation:function(){let i=this.target.position.x-(this.position.x+h.width/2/this.zoomLevel),t=this.target.position.y-(this.position.y+h.height/2/this.zoomLevel);Math.abs(i)>this.boundaryX?(this.moveX=this.target.velocity.x,this.position.x=z(this.position.x,this.target.position.x-h.width/2/this.zoomLevel,this.followSpeed)):this.moveX=0,Math.abs(t)>this.boundaryY?(this.moveY=this.target.velocity.y,this.position.y=z(this.position.y,this.target.position.y-h.height/2/this.zoomLevel,this.followSpeed)):this.moveY=0,a.scale(this.zoomLevel,this.zoomLevel),a.translate(-this.position.x,-this.position.y)},resetTransformation:function(){a.setTransform(1,0,0,1,0,0)},setZoom:function(i){this.zoomLevel=i},Render:function(){this.child.sort(((i,t)=>i.layer-t.layer)),this.child.forEach((i=>{i.globalPosition&&i.globalPosition(this.position),i.visible&&i.Render&&i.Render()}))},reset:function(){this.position=new e(0,0),this.target=void 0,this.followSpeed=.05,this.boundaryX=0,this.boundaryY=0,this.zoomLevel=1}};function y(i,t){void 0!==t?console.log(i,t):console.log(i)}function f(i,t){document.addEventListener(i,t)}function g(i){return null!=i.size?i.position.x+i.size.x>m.position.x&&i.position.x<m.position.x+h.width/m.zoomLevel&&i.position.y+i.size.y>m.position.y&&i.position.y<m.position.y+h.height/m.zoomLevel:i.position.x>m.position.x&&i.position.x<m.position.x+h.width/m.zoomLevel&&i.position.y>m.position.y&&i.position.y<m.position.y+h.height/m.zoomLevel}function x(i){"boolean"==typeof i?o.pause=i:console.error("el parametro no es un boolean (true, false)")}function w(i,t){localStorage.setItem(i,t)}function v(i){return localStorage.getItem(i)}function b(i){localStorage.removeItem(i)}function _(){localStorage.clear()}function z(i,t,e){return(1-e)*i+e*t}function S(i,t){return Math.floor(Math.random()*(t-i+1))+i}function R(i,t){return i<t||i===t?i:t}function P(i,t){return t>i||t===i?t:i}function E(i){p.clearGrid(),i.forEach((i=>{p.addToGrid(i)})),i.forEach((i=>{p.getNearbyObjects(i).forEach((t=>{if(i.parent.name!==t.parent.name)for(let e of i.mask)t.collision_layer===e&&M(i,t)}))}))}let T={delta:0,lastTime:0,lastUpdateFps:0,deltaTime:function(){return this.delta}},C={keys:{},mouse:{x:0,y:0,isDown:!1},isMouseMoving:!1,update:function(){window.addEventListener("keydown",(i=>{this.keys[i.code]||(this.keys[i.code]=!0,i.preventDefault())})),window.addEventListener("keyup",(i=>{this.keys[i.code]&&(this.keys[i.code]=!1,i.preventDefault())})),window.addEventListener("mousedown",(i=>{this.mouse.isDown||(this.mouse.isDown=!0,this.mouse.x=i.clientX,this.mouse.y=i.clientY)})),window.addEventListener("mouseup",(()=>{this.mouse.isDown&&(this.mouse.isDown=!1)})),window.addEventListener("mousemove",(i=>{this.isMouseMoving||(this.isMouseMoving=!0,this.mouse.x=i.clientX,this.mouse.y=i.clientY)})),window.addEventListener("click",(()=>{null!=this.isClick&&this.isClick()}))},isKeyDown:function(i){return!!this.keys[i]},getMousePosition:function(){return{x:this.mouse.x,y:this.mouse.y}},isMouseDown:function(){return this.mouse.isDown}};class I{constructor(i){this.cellSize=i,this.grid=new Map}getCell(i){return`${Math.floor(i.x/this.cellSize)},${Math.floor(i.y/this.cellSize)}`}addToGrid(i){const t=this.getCell(i.position),e=this.getCell({x:i.position.x+i.size.x,y:i.position.y+i.size.y}),[s,o]=t.split(",").map(Number),[n,r]=e.split(",").map(Number);for(let t=s;t<=n;t++)for(let e=o;e<=r;e++){const s=`${t},${e}`;this.grid.has(s)||this.grid.set(s,[]),this.grid.get(s).push(i)}}getNearbyObjects(i){const t=this.getCell(i.position),[e,s]=t.split(",").map(Number),o=[];for(let i=-1;i<=1;i++)for(let t=-1;t<=1;t++){const n=`${e+i},${s+t}`;this.grid.has(n)&&o.push(...this.grid.get(n))}return o}clearGrid(){this.grid.clear()}}function M(i,t){i.updateBorder(),t.updateBorder();const e=Math.min(i.borderRight-t.position.x,t.borderRight-i.position.x),s=Math.min(i.borderDown-t.position.y,t.borderDown-i.position.y);"Trigger"===i.type&&(i.bodyEnter(t)?t.trigger||(t.trigger=!0,void 0!==i.parent.is_trigger_enter&&i.parent.is_trigger_enter(t.parent)):t.trigger&&(void 0!==i.parent.is_trigger_exit&&i.parent.is_trigger_exit(t.parent),t.trigger=!1)),"CharacterBody"===i.type&&"Static"===t.type&&(i.bodyEnter(t)?(t.collisionStatic=!0,e<s?i.position.x<t.position.x?(i.borderRight>t.position.x+2&&(i.parent.position.x-=1),i.parent.velocity.x=0,i.parent.slice_right=!1,i.parent.isWall=!0):(i.position.x<t.borderRight-2&&(i.parent.position.x+=1),i.parent.velocity.x=0,i.parent.slice_left=!1,i.parent.isWall=!0):i.position.y<t.position.y?(i.parent.restitution>0?(i.parent.position.y=i.parent.position.y-i.parent.restitution,i.parent.restitution-=1):i.borderDown>t.position.y+2&&(i.parent.position.y-=2),i.parent.velocity.y=0,i.parent.slice_down=!1,i.parent.isFloor=!0):(i.position.y<t.borderDown-2&&(i.parent.position.y+=1),i.parent.velocity.y=0,i.parent.slice_up=!1,i.parent.isCeiling=!0)):t.collisionStatic&&(i.parent.slice_right=!0,i.parent.slice_left=!0,i.parent.slice_down=!0,i.parent.slice_up=!0,i.parent.isFloor=!1,i.parent.isWall=!1,i.parent.isCeiling=!1,t.collisionStatic=!1)),"CharacterBody"===i.type&&"Plataform"===t.type&&(i.bodyEnter(t)?(t.collisionPlataform=!0,e<s?i.position.x<t.position.x?(i.borderRight>t.position.x+2&&(i.parent.position.x-=1),i.parent.velocity.x=0,i.parent.slice_right=!1,i.parent.isWall=!0):(i.position.x<t.borderRight-2&&(i.parent.position.x+=1),i.parent.velocity.x=0,i.parent.slice_left=!1,i.parent.isWall=!0):i.borderDown<t.position.y+t.scale.y/2&&i.parent.velocity.y>0&&(i.parent.velocity.y=0,i.parent.slice_down=!1,i.parent.isFloor=!0)):t.collisionPlataform&&(i.parent.slice_right=!0,i.parent.slice_left=!0,i.parent.slice_down=!0,i.parent.slice_up=!0,i.parent.isFloor=!1,i.parent.isWall=!1,t.collisionPlataform=!1)),"CharacterBody"===i.type&&"RigidBody"===t.type&&(i.bodyEnter(t)?(t.collisionRigidBody=!0,e<s?i.position.x<t.position.x?(i.parent.slice_right=!1,t.parent.friction=.9,t.parent.velocity.x=(t.parent.velocity.x+Math.abs(i.parent.velocity.x/4))*t.parent.friction,i.parent.isWall=!0):(i.parent.slice_left=!1,t.parent.friction=.9,t.parent.velocity.x=(t.parent.velocity.x-Math.abs(i.parent.velocity.x/4))*t.parent.friction,i.parent.isWall=!0):i.position.y<t.position.y?(i.borderDown>t.position.y+2&&(i.parent.position.y-=i.parent.restitution),i.parent.velocity.y=0,i.parent.slice_down=!1,i.parent.isFloor=!0):(i.position.y<t.borderDown-2&&(i.parent.position.y+=1),i.parent.velocity.y=0,i.parent.slice_up=!1,i.parent.isCeiling=!0)):t.collisionRigidBody&&(i.parent.slice_right=!0,i.parent.slice_left=!0,i.parent.slice_down=!0,i.parent.slice_up=!0,i.parent.isFloor=!1,i.parent.isWall=!1,i.parent.isCeiling=!1,t.collisionRigidBody=!1)),"RigidBody"===i.type&&"Static"===t.type&&(i.bodyEnter(t)?(t.rigidBody=!0,e<s?i.position.x<t.position.x?(i.borderRight>t.position.x+2&&(i.parent.position.x-=1),i.parent.velocity.x=0,i.parent.slice_right=!1,i.parent.isWall=!0):(i.position.x<t.borderRight-2&&(i.parent.position.x+=1),i.parent.velocity.x=0,i.parent.slice_left=!1,i.parent.isWall=!0):i.position.y<t.position.y?(i.borderDown>t.position.y+2&&(i.parent.position.y-=i.parent.restitution),i.parent.velocity.y=0,i.parent.slice_down=!1,i.parent.isFloor=!0):(i.position.y<t.borderDown-2&&(i.parent.position.y+=1),i.parent.velocity.y=0,i.parent.slice_up=!1,i.parent.isCeiling=!0)):t.rigidBody&&(i.parent.slice_right=!0,i.parent.slice_left=!0,i.parent.slice_down=!0,i.parent.slice_up=!0,i.parent.isFloor=!1,i.parent.isWall=!1,i.parent.isCeiling=!1,t.rigidBody=!1)),"RigidBody"===i.type&&"Plataform"===t.type&&(i.bodyEnter(t)?(t.plataform=!0,e<s?i.position.x<t.position.x?(i.borderRight>t.position.x+2&&(i.parent.position.x-=1),i.parent.velocity.x=0,i.parent.slice_right=!1,i.parent.isWall=!0):(i.position.x<t.borderRight-2&&(i.parent.position.x+=1),i.parent.velocity.x=0,i.parent.slice_left=!1,i.parent.isWall=!0):i.borderDown<t.position.y+t.scale.y/2&&i.parent.velocity.y>0&&(i.parent.velocity.y=0,i.parent.slice_down=!1,i.parent.isFloor=!0)):t.plataform&&(i.parent.slice_right=!0,i.parent.slice_left=!0,i.parent.slice_down=!0,i.parent.slice_up=!0,i.parent.isFloor=!1,i.parent.isWall=!1,t.plataform=!1))}class L{#i;#t;#e=!1;constructor(i){document.body.style.overflow="hidden";let t=void 0!==i.container?document.getElementById(i.container):document.body;n=document.createElement("canvas"),n.style.position="absolute",n.style.left=`${t.left}px`,n.style.top=`${t.top}px`,n.width=i.width,n.height=i.height,n.style.background=void 0!==i.color?i.color:"black",r=n.getContext("2d"),t.appendChild(n),h=document.createElement("canvas"),a=h.getContext("2d"),h.width=i.width,h.height=i.height,l=document.createElement("canvas"),c=l.getContext("2d"),l.width=i.width,l.height=i.height,l.style.position="absolute",l.style.left=`${t.left}px`,l.style.top=`${t.top}px`,t.appendChild(l),this.#e=void 0!==i.texture_filter&&i.texture_filter,this.#i=0,this.#t=0,this.debugFPS=new B("FPS : "+this.#t,new e(15,25),20,"Arial","black"),d=void 0!==i.debugs&&i.debugs,p=new I(250)}#s(){a.clearRect(0,0,h.width,h.height)}#o(){r.clearRect(0,0,n.width,n.height),r.drawImage(h,0,0)}#n(i){this.#i++,o.pause?(T.delta=0,T.lastTime=0):(T.delta=Math.min((i-T.lastTime)/1e3,.1),T.lastTime=i),d&&i-T.lastUpdateFps>=1e3&&(this.#t=this.#i,this.#i=0,this.debugFPS.text="FPS : "+this.#t,T.lastUpdateFps=i),m.child.length>0&&m.Render();let t=o;t&&(t.child.sort(((i,t)=>i.layer-t.layer)),t.child.forEach((i=>{void 0===i.process||t.pause||i.process(),void 0===i.move_and_slide||t.pause||i.move_and_slide(),void 0!==i.Render&&g(i)&&i.visible&&i.Render()})),t.child.length>0&&t.child.forEach((i=>{void 0!==i.collider&&null!==i.collider&&u.push(i.collider),void 0!==i.child&&i.addCollision()})),u.length>1&&(E(u),u=[]),void 0===t.process||t.pause?void 0!==t.process&&t.process(0):t.process(T.deltaTime()))}#r(){$.Render(),$.Process()}#h(i){this.#s(),a.imageSmoothingEnabled=this.#e,c.imageSmoothingEnabled=this.#e,null!=m.target&&m.applyTransformation(),c.clearRect(0,0,l.width,l.height),$.child.length>0&&this.#r(),d&&this.debugFPS.Render(),this.#n(i),this.#o(),null!=m.target&&m.resetTransformation(),window.requestAnimationFrame(this.#h.bind(this))}add_scene(i){i.child=[],i.audios=[],i.pause=!1,i.add_child=function(t){if(t instanceof K)o.audios.push(t);else if(t instanceof B||t instanceof O||t instanceof N)$.add_child(t);else{if(!(t instanceof G))return o.child.find((i=>i.name===t.name))?(console.error(`El objeto ${t.name} ya existe.`),void console.error("Si lo que deseas es instanciar varios objetos, intenta usando el metodo 'instantiate()'.")):(t.parent=i,void i.child.push(t));m.child.push(t)}},i.name=i.name||s.length,s.push(i)}change_scene(i){i.name!==o.name&&(this.#a(),s.includes(i)&&o.name!==i.name&&(o=i,this.reload_scene()))}#a(){m.child=[],m.reset(),m.resetTransformation(),$.child=[],o.audios.forEach((i=>{i.stop()})),o.audios=[],o.child=[]}reload_scene(){w("currentScene",o.name),location.reload()}start(i){window.addEventListener("load",(()=>{if(C.update(),this.add_scene(i),null!==v("currentScene")){let i=v("currentScene");o=s.find((t=>t.name===i)),b("currentScene")}else o=i;"function"==typeof o.ready&&o.ready(),this.#h(0)}))}}let $={child:[],Render:function(){this.child.sort(((i,t)=>i.layer-t.layer)),this.child.forEach((i=>{i.visible&&i.Render&&i.Render()}))},Process:function(){this.child.forEach((i=>{i.process&&i.process()}))},add_child:function(i){this.child.push(i)}};class D{#l=0;constructor(i=1){this.time=i,this.#l=0,this.loop=!0,this.play=!1,this.time_finish=!1}process(){o.pause||(this.#l<this.time&&this.play?this.#l+=T.deltaTime():(this.time_finish||(this.func(),this.time_finish=!0),this.loop&&(this.#l=0,this.time_finish=!1)))}func(){}start(i){this.play||(this.func=i,this.play=!0)}stop(){this.play&&(this.#l=0)}}class B{#c;constructor(i="undefined",t=new e,s=50,o="Arial",n="blue"){let r=S(t.x+t.y+s,1e4);this.name=`${r}`,this.text="string"==typeof i?i:"",this.font="string"==typeof o?o:"Arial",this.position=t instanceof e?t:new e,this.size=Number.isInteger(s)?s+"px":"10px",this.color="string"==typeof n?n:"blue",this.visible=!0,this.layer=0,this.#c=0}setRotation(i){o.pause||(this.#c=Number.isInteger(i)?i*(Math.PI/180):0)}Render(){c.save(),c.font=`${this.size} ${this.font}`;const i=c.measureText(this.text).width;c.translate(this.position.x+i/2,this.position.y+parseInt(this.size)/2),c.rotate(this.#c),c.textBaseline="middle",c.textAlign="center",c.fillStyle=this.color,c.fillText(this.text,0,0),c.restore()}}class O{#d;#p;#c;#u;constructor(i="undefined",t=new e,s=new e){this.name="string"==typeof i?i:"indefinido",this.parent=null,this.myScene=o.name,this.position=t instanceof e?t:new e,this.size=s instanceof e?s:new e(100,100),this.visible=!0,this.scale=1,this.layer=0,this.child=[],this.color="white",this.borderColor="black",this.pressedColor="grey",this.#d=!1,this.activeTouches=new Set,this.borderRadius=10,this.shadowOffsetX=4,this.shadowOffsetY=4,this.shadowBlur=10,this.shadowColor="rgba(0, 0, 0, 0.3)",this.disabled=!1,this.#p=!1,this.#u=!1,this.#c=0,l.addEventListener("touchstart",this.handleTouchStart.bind(this)),l.addEventListener("touchend",this.handleTouchEnd.bind(this)),l.addEventListener("touchcancel",this.handleTouchEnd.bind(this)),l.addEventListener("mousedown",this.handleMouseDown.bind(this)),l.addEventListener("mouseup",this.handleMouseUp.bind(this))}setRotation(i){o.pause||(this.#c=Number.isInteger(i)?i*(Math.PI/180):0,this.child.forEach((t=>{"function"==typeof t.setRotation&&t.setRotation(i)})))}isVisible(){return!(!this.parent||!this.parent.visible)||!!this.visible}isPressed(){return this.#d}isDown(){return!this.#p&&this.#d?(this.#p=!0,this.#d):(this.#d||(this.#p=!1),!1)}isUp(){return this.#u&&!this.#d?(this.#u=!1,!this.#d):(this.#d&&(this.#u=!0),!1)}scaler(){this.scale<1&&this.scale>.1&&(this.size=this.size.multiply(this.scale),this.scale=1)}Render(){this.scaler();const i=this.#d?this.pressedColor:this.color;c.fillStyle=i,c.save();const t=this.position.x+this.size.x/2,e=this.position.y+this.size.y/2;c.translate(t,e),c.rotate(this.#c),c.translate(-t,-e),c.shadowOffsetX=this.shadowOffsetX,c.shadowOffsetY=this.shadowOffsetY,c.shadowBlur=this.shadowBlur,c.shadowColor=this.shadowColor,this.roundRect(c,this.position.x,this.position.y,this.size.x,this.size.y,this.borderRadius),c.fill(),c.strokeStyle=this.borderColor,c.lineWidth=2,c.stroke(),c.restore(),this.RenderChild()}RenderChild(){this.child.sort(((i,t)=>i.layer-t.layer)),this.child.forEach((i=>{i.Render&&i.visible&&i.Render()}))}roundRect(i,t,e,s,o,n){i.beginPath(),i.moveTo(t+n,e),i.lineTo(t+s-n,e),i.quadraticCurveTo(t+s,e,t+s,e+n),i.lineTo(t+s,e+o-n),i.quadraticCurveTo(t+s,e+o,t+s-n,e+o),i.lineTo(t+n,e+o),i.quadraticCurveTo(t,e+o,t,e+o-n),i.lineTo(t,e+n),i.quadraticCurveTo(t,e,t+n,e),i.closePath()}handleTouchStart(i){if(this.myScene!==o.name)return;const t=i.changedTouches,e=l.getBoundingClientRect();for(let i=0;i<t.length;i++){let s=t[i].clientX-e.left,o=t[i].clientY-e.top;this.isInsideBounds(s,o)&&(this.disabled||(this.#d=!0),this.activeTouches.add(t[i].identifier))}}handleTouchEnd(i){if(this.myScene!==o.name)return;const t=i.changedTouches;for(let i=0;i<t.length;i++){let e=t[i].identifier;this.activeTouches.has(e)&&(this.activeTouches.delete(e),0===this.activeTouches.size&&(this.disabled||(this.#d=!1)))}}handleMouseDown(i){if(this.myScene!==o.name)return;const t=l.getBoundingClientRect(),e=i.clientX-t.left,s=i.clientY-t.top;this.isInsideBounds(e,s)&&(this.disabled||(this.#d=!0))}handleMouseUp(i){if(this.myScene!==o.name)return;const t=l.getBoundingClientRect(),e=i.clientX-t.left,s=i.clientY-t.top;this.isInsideBounds(e,s)&&(this.disabled||(this.#d=!1))}isInsideBounds(i,t){return i>=this.position.x&&i<=this.position.x+this.size.x&&t>=this.position.y&&t<=this.position.y+this.size.y}add_child(i){if(i instanceof B){let t=this.position.add(i.position);i.position=t,this.child.push(i)}else console.error(`El objeto ${i.name} no se puede añadir al objeto ${this.name}.\n`),console.warn("El objeto permitido es: Label.")}}class j extends O{#c;constructor(i="undefind",t=new e,s=new e,o="white",n="black",r="grey"){super(i,t,s),this.color=o,this.borderColor=n,this.pressedColor=r,this.#c=0}}class F extends O{#d;#p=!1;#c;#u;constructor(i="undefined",t=new e,s=new e,o="undefined",n="undefined"){try{super(i,t,s),this.texture_pressed=new Image,this.texture_normal=new Image,this.img=new Image,this.texture_pressed.src="string"==typeof n?n:"",this.texture_normal.src="string"==typeof o?o:"",this.img.src="string"==typeof o?o:"",this.textureNormalSpriteSheet=o instanceof q?o:null,this.texturePressedSpriteSheet=n instanceof q?n:null,this.cutSize=new e,this.cutPosition=new e,null!==this.textureNormalSpriteSheet&&(this.img.src=o.img.src,this.texture_normal.src=o.img.src,this.cutSize=o.size,this.cutPosition=o.position),null!==this.texturePressedSpriteSheet&&(this.texture_pressed.src=n.img.src),this.#d=!1,this.#u=!1,this.activeTouches=new Set,this.#c=0,this.img.onerror=()=>{console.error("Error al cargar la imagen:",this.img.src),this.img=null},this.texture_normal.onerror=()=>{console.error("Error al cargar la textura normal:",this.texture_normal.src),this.texture_normal=null},this.texture_pressed.onerror=()=>{console.error("Error al cargar la textura presionada:",this.texture_pressed.src),this.texture_pressed=null}}catch(i){console.error(`Error en el constructor: ${i.message}`),this.texture_pressed=null,this.texture_normal=null,this.img=null,this.textureNormalSpriteSheet=null,this.texturePressedSpriteSheet=null,this.cutSize=new e,this.cutPosition=new e,this.#d=!1,this.#u=!1,this.activeTouches=new Set,this.#c=0}}setRotation(i){o.pause||(this.#c=Number.isInteger(i)?i*(Math.PI/180):0,this.child.forEach((t=>{"function"==typeof t.setRotation&&t.setRotation(i)})))}isPressed(){return this.#d}isDown(){return!this.#p&&this.#d?(this.#p=!0,this.#d):(this.#d||(this.#p=!1),!1)}isUp(){return this.#u&&!this.#d?(this.#u=!1,!this.#d):(this.#d&&(this.#u=!0),!1)}Render(){super.scaler(),c.save(),c.translate(this.position.x+this.size.x/2,this.position.y+this.size.y/2),c.rotate(this.#c),null!==this.textureNormalSpriteSheet&&null!==this.texturePressedSpriteSheet?c.drawImage(this.img,this.cutPosition.x,this.cutPosition.y,this.cutSize.x,this.cutSize.y,-this.size.x/2,-this.size.y/2,this.size.x,this.size.y):c.drawImage(this.img,-this.size.x/2,-this.size.y/2,this.size.x,this.size.y),c.restore(),super.RenderChild()}handleTouchStart(i){if(this.myScene!==o.name)return;const t=i.changedTouches,e=l.getBoundingClientRect();for(let i=0;i<t.length;i++){let s=t[i].clientX-e.left,o=t[i].clientY-e.top;s>=this.position.x&&s<=this.position.x+this.size.x&&o>=this.position.y&&o<=this.position.y+this.size.y&&(this.disabled||(this.#d=!0),this.img=this.texture_pressed,null!==this.texturePressedSpriteSheet&&(this.cutPosition=this.texturePressedSpriteSheet.position,this.cutSize=this.texturePressedSpriteSheet.size),this.activeTouches.add(t[i].identifier))}}handleTouchEnd(i){if(this.myScene!==o.name)return;const t=i.changedTouches;for(let i=0;i<t.length;i++){let e=t[i].identifier;this.activeTouches.has(e)&&(this.activeTouches.delete(e),0===this.activeTouches.size&&(this.disabled||(this.#d=!1),this.img=this.texture_normal,null!==this.textureNormalSpriteSheet&&(this.cutPosition=this.textureNormalSpriteSheet.position,this.cutSize=this.textureNormalSpriteSheet.size)))}}handleMouseDown(i){if(this.myScene!==o.name)return;const t=l.getBoundingClientRect(),e=i.clientX-t.left,s=i.clientY-t.top;super.isInsideBounds(e,s)&&(this.disabled||(this.#d=!0),this.img=this.texture_pressed,null!==this.texturePressedSpriteSheet&&(this.cutPosition=this.texturePressedSpriteSheet.position,this.cutSize=this.texturePressedSpriteSheet.size))}handleMouseUp(i){if(this.myScene!==o.name)return;const t=l.getBoundingClientRect(),e=i.clientX-t.left,s=i.clientY-t.top;super.isInsideBounds(e,s)&&(this.disabled||(this.#d=!1),this.img=this.texture_normal,null!==this.textureNormalSpriteSheet&&(this.cutPosition=this.textureNormalSpriteSheet.position,this.cutSize=this.textureNormalSpriteSheet.size))}}class k extends F{constructor(i="undefined",t=new e,s=new e,o="undefined",n="undefined",r=50){super(i,t,s,o,o);try{this.texture_inner=new Image,this.texture_inner.src=n}catch(i){console.error(`Error al cargar la textura_inner '${n}':`,i.message),this.texture_inner=null}this.axisX=0,this.axisY=0,this.center={x:this.position.x+this.size.x/2,y:this.position.y+this.size.y/2},this.maxDistance=r,this.innerPos={x:this.center.x,y:this.center.y},l.addEventListener("touchmove",this.handleTouchMove.bind(this))}Render(){c.drawImage(this.img,this.position.x,this.position.y,this.size.x,this.size.y),c.drawImage(this.texture_inner,this.innerPos.x-this.size.x/4,this.innerPos.y-this.size.y/4,this.size.x/2,this.size.y/2),super.RenderChild()}handleTouchMove(i){const t=i.changedTouches,e=l.getBoundingClientRect();for(let i=0;i<t.length;i++){let s=t[i].clientX-e.left,n=t[i].clientY-e.top;if(this.isPressed&&this.activeTouches.has(t[i].identifier)){let i=s-this.center.x,t=n-this.center.y,e=Math.sqrt(i*i+t*t);if(e>this.maxDistance){let s=this.maxDistance/e;i*=s,t*=s}this.innerPos.x=this.center.x+i,this.innerPos.y=this.center.y+t,this.axisX=i/this.maxDistance,this.axisY=t/this.maxDistance,this.onMove&&!o.pause&&this.onMove(this.axisX,this.axisY)}}}handleTouchEnd(i){super.handleTouchEnd(i),0===this.activeTouches.size&&(this.innerPos.x=this.center.x,this.innerPos.y=this.center.y,this.axisX=0,this.axisY=0)}}class N{#c;constructor(i="undefined",t=new e,s=new e,o="undefined"){try{this.name="string"==typeof i?i:"indefinido",this.position=t instanceof e?t:new e,this.size=s instanceof e?s:new e,this.scale=1,this.visible=!0,this.layer=0,this.child=[],this.img=new Image,"string"==typeof o&&"undefined"!==o?this.img.src=o:o instanceof q&&o.img&&o.img.src?(this.path=o,this.img.src=this.path.img.src):(console.warn("El parámetro 'path' no es una cadena válida ni un SpriteSheet válido."),this.img.src="",this.path=null),this.img.onerror=()=>{console.error(`No se pudo cargar la imagen: ${o}`),this.img=null},this.flip_h=!1,this.flip_v=!1,this.#c=0,this.color=null,this.alpha=1}catch(i){console.error(`Error en el constructor: ${i.message}`),this.name="indefinido",this.position=new e,this.size=new e,this.scale=1,this.visible=!0,this.layer=0,this.child=[],this.img=null,this.path=null,this.flip_h=!1,this.flip_v=!1,this.#c=0,this.color=null,this.alpha=1}}scaler(){this.scale<1&&(this.size=this.size.multiply(this.scale),this.scale=1)}setRotation(i){o.pause||(this.#c=Number.isInteger(i)?i*(Math.PI/180):0,this.child.forEach((t=>{"function"==typeof t.setRotation&&t.setRotation(i)})))}add_child(i){this.child.forEach((t=>{t.name!==i.name||console.error(`El objeto ${i.name} ya existe.`)}));let t=this.position.add(i.position);i.position=t,this.child.push(i)}Render(){if(this.scaler(),c.save(),c.globalAlpha=this.alpha,c.translate(this.position.x+this.size.x/2,this.position.y+this.size.y/2),c.rotate(this.#c),(this.flip_h||this.flip_v)&&c.scale(this.flip_h?-1:1,this.flip_v?-1:1),null!==this.path?c.drawImage(this.img,this.path.position.x,this.path.position.y,this.path.size.x,this.path.size.y,-this.size.x/2,-this.size.y/2,this.size.x,this.size.y):c.drawImage(this.img,-this.size.x/2,-this.size.y/2,this.size.x,this.size.y),this.color&&(c.globalCompositeOperation="source-atop",c.fillStyle=this.color,c.fillRect(-this.size.x/2,-this.size.y/2,this.size.x,this.size.y),c.globalCompositeOperation="source-over"),c.globalAlpha=1,c.restore(),this.child.length>0){this.child.sort(((i,t)=>i.layer-t.layer));for(let i of this.child)null!=i.Render&&i.visible&&i.Render()}}}class A{constructor(i,t,s){this.name=i,this.parent=null,this.position=t,this.localPosition=t,this.size=s,this.velocity=new e,this.visible=!0,this.layer=0,this.child=[]}}class U extends A{#c;constructor(i="undefined",t=new e,s=new e){super(i,t,s),this.slice_right=!0,this.slice_left=!0,this.slice_up=!0,this.slice_down=!0,this.isFloor=!1,this.wasOnFloor=!1,this.isWall=!1,this.wasOnWall=!1,this.isCeiling=!1,this.wasOnCeiling=!1,this.collider=null,this.scale=1,this.restitution=2,this.saveRestitution=this.restitution}setRestitution(i){this.restitution=i,this.saveRestitution=i}setRotation(i){o.pause||(this.#c=Number.isInteger(i)?i*(Math.PI/180):0,this.child.forEach((t=>{"function"==typeof t.setRotation&&t.setRotation(i)})))}apply_impulse(i,t){this.velocity.x+=i,this.velocity.y+=t}scaler(){this.scale<1&&this.scale>.1&&(this.size=this.size.multiply(this.scale),this.scale=1)}is_in_floor(){return this.isFloor}is_in_floor_only(){return this.is_in_floor()&&!this.wasOnFloor?(this.wasOnFloor=!0,!0):(this.is_in_floor()||(this.wasOnFloor=!1),!1)}is_in_wall(){return this.isWall}is_in_wall_only(){return this.is_in_wall()&&!this.wasOnWall?(this.wasOnWall=!0,!0):(this.is_in_wall()||(this.wasOnWall=!1),!1)}is_in_ceiling(){return this.isCeiling}is_in_ceiling_only(){return this.is_in_ceiling()&&!this.wasOnCeiling?(this.wasOnCeiling=!0,!0):(this.is_in_ceiling()||(this.wasOnCeiling=!1),!1)}instantiate(){this.name=this.name+S(1,1e4)}center(){return new e(this.position.x+this.size.x/2,this.position.y+this.size.y/2)}add_child(i){if(i instanceof K&&o.audios.push(i),i.name!==this.name){for(let t of this.child)if(i.name===t.name)return console.error(`El objeto ${i.name} ya existe como hijo de ${this.name}\n`),void console.warn("El método add_child solo debe ser usado dentro de la función ready.");if(i instanceof Q&&null===this.collider)i.parent=this,this.collider=i;else if(i instanceof Q)return void console.error(`El objeto ${this.name} ya tiene una colisión.`);if(i instanceof B&&!(i instanceof Text))return console.error(`El objeto ${i} no se puede agregar como hijo \n`),void console.warn("Para añadir un objeto de texto debes usar la clase Text envés de Label.");if(i instanceof O||i instanceof N)return console.error(`El objeto ${i.name} no se puede agregar como hijo \n`),void console.warn("Los objetos de Interfaz no se pueden añadir como hijos de "+this.name);if(i instanceof G||i instanceof J)console.error(`El objeto ${i.name} no se puede agregar como hijo de ${this.name} \n`);else if(null!=i.size){i.parent=this;let t=this.center().subtract(new e(i.size.x/2,i.size.y/2));i.position=t,this.child.push(i)}else{i.parent=this;let t=this.position.add(i.position);i.position=t,this.child.push(i)}}else console.error(`El objeto ${i.name} no se puede agregar a si mismo\n`)}destroy(){if(null!=this.parent)for(let i=0;i<this.parent.child.length;i++)this.parent.child[i].name===this.name&&this.parent.child.splice(i,1)}Render(){if(this.child.length>0){this.child.sort(((i,t)=>i.layer-t.layer));for(let i of this.child)null!=i.Render&&i.visible&&i.Render()}}globalPosition(i=new e,t=new e){let s=t.subtract(new e(this.size.x/2,this.size.y/2));this.position=this.localPosition.add(s)}move_and_slide(){if(o.pause)return;this.restitution<=0&&!this.is_in_floor()&&this.velocity.y<0&&(this.restitution=this.saveRestitution);const i=this.velocity.x*Time.delta,t=this.velocity.y*Time.delta;(this.slice_right&&this.velocity.x>0||this.slice_left&&this.velocity.x<0)&&(this.position.x+=i),(this.slice_down&&this.velocity.y>0||this.slice_up&&this.velocity.y<0)&&(this.position.y+=t),this.friction>0&&(this.velocity.x*=this.friction,this.velocity.y*=this.friction),this._processChildren()}#m(i){return"function"==typeof i}_processChildren(){for(let i of this.child)i.globalPosition(this.position,this.center()),this.#m(i.move_and_slide)&&i.move_and_slide(),this.#m(i._process)&&i._process(),this.#m(i.process)&&i.process()}addCollision(){this.child.length>0&&this.child.forEach((i=>{void 0!==i.collider&&null!==i.collider&&u.push(i.collider),void 0!==i.child&&void 0!==i.addCollision&&i.addCollision()}))}}class X extends U{#c;constructor(i="undefind",t=new e,s=new e,o="Rectangle",n="white"){super(i,t,s),this.shape=o,this.color=n,this.#c=0}setRotation(i){o.pause||(this.#c=Number.isInteger(i)?i*(Math.PI/180):0,this.child.forEach((t=>{"function"==typeof t.setRotation&&t.setRotation(i)})))}Render(){switch(super.scaler(),a.save(),a.translate(this.position.x+this.size.x/2,this.position.y+this.size.y/2),a.rotate(this.#c),this.shape){case"Rectangle":a.fillStyle=this.color,a.fillRect(-this.size.x/2,-this.size.y/2,this.size.x,this.size.y);break;case"Circle":{let i=this.size.x/2;a.beginPath(),a.arc(0,0,i,0,2*Math.PI),a.closePath(),a.fillStyle=this.color,a.fill()}break;case"Triangle":a.beginPath(),a.moveTo(0,-Math.sqrt(3)/2*this.size.x/2),a.lineTo(-this.size.x/2,Math.sqrt(3)/2*this.size.x/2),a.lineTo(this.size.x/2,Math.sqrt(3)/2*this.size.x/2),a.closePath(),a.fillStyle=this.color,a.fill()}a.restore(),super.Render()}}class Y extends B{#c;constructor(i="undefined",t=new e,s=50,o="Arial",n="white"){super(i,t,s,o,n),this.localPosition=t,this.#c=0}setRotation(i){o.pause||(this.#c=Number.isInteger(i)?i*(Math.PI/180):0)}Render(){a.save(),a.font=`${this.size} ${this.font}`;const i=a.measureText(this.text).width,t=parseInt(this.size);a.translate(this.position.x+i/2,this.position.y+t/2),a.rotate(this.#c),a.textBaseline="middle",a.textAlign="center",a.fillStyle=this.color,a.fillText(this.text,0,0),a.restore()}globalPosition(i=new e){this.position=i.add(this.localPosition)}}class W extends U{#c;constructor(i="undefined",t=new e,s=new e,o="undefined"){super(i,t,s);try{this.img=new Image,"string"==typeof o?this.img.src=o:o instanceof q&&o.img&&o.img.src?(this.path=o,this.img.src=this.path.img.src):(console.warn("El parámetro 'path' no es una cadena válida ni un SpriteSheet válido."),this.img.src="",this.path=null)}catch(i){console.error(`Error al cargar la imagen: ${i.message}`),this.img=null,this.path=null}this.flip_h=!1,this.flip_v=!1,this.#c=0,this.color=null,this.alpha=1}setRotation(i){o.pause||(this.#c=Number.isInteger(i)?i*(Math.PI/180):0,this.child.forEach((t=>{"function"==typeof t.setRotation&&t.setRotation(i)})))}Render(){super.scaler(),a.save(),a.globalAlpha=this.alpha,a.translate(this.position.x+this.size.x/2,this.position.y+this.size.y/2),a.rotate(this.#c),(this.flip_h||this.flip_v)&&a.scale(this.flip_h?-1:1,this.flip_v?-1:1),null!==this.path?a.drawImage(this.img,this.path.position.x,this.path.position.y,this.path.size.x,this.path.size.y,-this.size.x/2,-this.size.y/2,this.size.x,this.size.y):a.drawImage(this.img,-this.size.x/2,-this.size.y/2,this.size.x,this.size.y),this.color&&(a.globalCompositeOperation="source-atop",a.fillStyle=this.color,a.fillRect(-this.size.x/2,-this.size.y/2,this.size.x,this.size.y),a.globalCompositeOperation="source-over"),a.globalAlpha=1,a.restore(),super.Render()}}class q{constructor(i="undefined",t=new e,s=new e,o=new e,n="undefined"){try{if(this.name=i,!(t instanceof e&&s instanceof e&&o instanceof e))throw new Error("Los parámetros 'position', 'frames' y 'pixels' deben ser instancias de Vector2.");if(this.position=new e(t.x*o.x,t.y*o.y),this.size=new e(s.x*o.x,s.y*o.y),this.img=new Image,"string"!=typeof n||"undefined"===n)throw new Error("El parámetro 'pathImage' no es una cadena de texto válida.");this.img.src=n,this.img.onerror=()=>{console.error(`No se pudo cargar la imagen: ${n}`),this.img=null},this.frames=o}catch(i){console.error(`Error en el constructor: ${i.message}`),this.name="undefined",this.position=new e,this.size=new e,this.img=null,this.frames=new e}}}class V extends U{#c;#y;constructor(i="undefined",t=new e,s=new e,o=[],n=.3){super(i,t,s);try{if(!Array.isArray(o))throw new Error("El parámetro 'animations' debe ser un array.");this.anim=o}catch(i){console.error("Error al inicializar AnimatedSprite:",i.message),this.anim=[]}this.flip_h=!1,this.flip_v=!1,this.currentAnim="",this.x=0,this.y=0,this.loop=!0,this.#y=!1,this.speed=n,this.speedFrame=new D(this.speed),this.animation_finish=!1,this.#c=0,this.color=null,this.alpha=1}setRotation(i){o.pause||(this.#c=Number.isInteger(i)?i*(Math.PI/180):0,this.child.forEach((t=>{"function"==typeof t.setRotation&&t.setRotation(i)})))}wait=()=>{if(this.#y){const i=this.anim.find((i=>i.name===this.currentAnim));i&&(this.x<i.size.x-i.frames.x?this.x+=i.frames.x:this.y<i.size.y-i.frames.y?(this.y+=i.frames.y,this.x=i.position.x):this.loop?(this.x=i.position.x,this.y=i.position.y):(this.animation_finish=!0,this.stop()))}};Render(){super.scaler();const i=this.anim.find((i=>i.name===this.currentAnim));a.save(),a.globalAlpha=this.alpha,a.translate(this.position.x+this.size.x/2,this.position.y+this.size.y/2),a.rotate(this.#c),(this.flip_h||this.flip_v)&&a.scale(this.flip_h?-1:1,this.flip_v?-1:1);const t=i?i.img:this.anim[0].img,e=i?this.x:this.anim[0].x,s=i?this.y:this.anim[0].y,o=i?i.frames.x:this.anim[0].frames.x,n=i?i.frames.y:this.anim[0].frames.y;a.drawImage(t,e,s,o,n,-this.size.x/2,-this.size.y/2,this.size.x,this.size.y),this.color&&(a.globalCompositeOperation="source-atop",a.fillStyle=this.color,a.fillRect(-this.size.x/2,-this.size.y/2,this.size.x,this.size.y),a.globalCompositeOperation="source-over"),a.globalAlpha=1,a.restore(),super.Render()}process(){this.speedFrame.process(),null!=this.animation_finish_name&&this.animation_finish&&this.animation_finish_name(this.currentAnim)}play(i){i!==this.currentAnim&&this.stop(),this.#y||(i!==this.currentAnim&&(this.anim.forEach((t=>{t.name===i&&(this.x=t.position.x,this.y=t.position.y)})),this.speedFrame.stop()),this.currentAnim=i,this.animation_finish=!1,this.#y=!0,this.anim.forEach((t=>{t.name===i&&(this.x=t.position.x,this.y=t.position.y)})),this.speedFrame.start(this.wait))}stop(){this.#y&&(this.#y=!1)}}class G{constructor(i="undefined",t=new e){this.name=i,this.position=t,this.localPosition=t,this.visible=!0,this.layer=0,this.child=[]}add_child(i){if(!(i instanceof J))return void console.error("Solo se permite objetos de tipo ParallaxLayer.");if(i.name===this.name)return void console.error(`No puedes añadir ${i.name} a si mismo.`);if(this.child.find((t=>t.name===i.name)))return void console.error(`El objeto ${i.name} ya existe.`);let t=i.position;i.position=t.add(this.position),this.child.push(i)}Render(){this.child.sort(((i,t)=>i.layer-t.layer)),this.child.forEach((i=>{i.globalPosition&&i.globalPosition(this.position),i.visible&&i.Render&&g(i)&&i.Render(),i._process&&i._process()}))}globalPosition(i=new e){this.position=i.add(this.localPosition)}}class J extends G{constructor(i="undefined",t=new e,s=new e,o="undefined",n=1){super(i,t),this.size=s,this.moveSpeed=n,this.img=new Image;try{"string"==typeof o?this.img.src=o:o instanceof q&&o.img&&o.img.src?(this.path=o,this.img.src=this.path.img.src):(this.path=null,this.img.src="",console.warn("El parámetro 'path' no es una cadena válida ni un SpriteSheet válido."))}catch(i){console.error(`Error al cargar la imagen: ${i.message}`),this.img=null}this.speed=0,this.offset=0}globalPosition(i=new e){this.position=i.add(this.localPosition)}Render(){let i=this.size.x,t=this.position.x+this.offset;for(let e=-1;e<=Math.ceil(h.width/i);e++){let s=t+e*i;null!==this.path?a.drawImage(this.img,this.path.position.x,this.path.position.y,this.path.size.x,this.path.size.y,s,this.position.y,this.size.x,this.size.y):a.drawImage(this.img,s,this.position.y,this.size.x,this.size.y)}}_process(){o.pause?this.offset=0:m.target?(m.moveX>0?this.speed=-this.moveSpeed:m.moveX<0?this.speed=this.moveSpeed:this.speed=0,this.offset+=this.speed,this.offset<=-this.size.x?this.offset+=this.size.x:this.offset>=this.size.x&&(this.offset-=this.size.x)):o.pause||(this.offset<=-this.size.x?this.offset+=this.size.x:this.offset>=this.size.x&&(this.offset-=this.size.x))}}class K extends A{#f;#g;constructor(i="undefined",t="undefined",s=!1){super(i,new e);try{this.sound=new Audio(t),this.sound.volume=1,this.sound.loop=s}catch(i){console.error(`Error al crear el audio '${t}':`,i.message),this.sound=null}this.#f=!1,this.#g=!1}setLoop(i){this.sound.loop=i}globalPosition(i=new e){this.position=i.add(this.localPosition)}play(){(!this.#f&&this.isVisible()&&!o.pause||!this.sound.loop&&this.isVisible()&&!o.pause)&&o&&(o.audios.find((i=>i.name===this.name))?(this.sound.play().catch((i=>{console.error("Error al reproducir audio:",i)})),this.#f=!0,this.#g=!1):console.error(`El objeto ${this.name} deve ser añadido a la Escena o a un objeto para que se pueda reproducir.`))}stop(){this.#g||(this.sound.pause(),this.sound.currentTime=0,this.#g=!0,this.#f=!1)}isVisible(){return this.position.x>=m.position.x&&this.position.x<=m.position.x+h.width/m.zoomLevel+200&&this.position.y>=m.position.y&&this.position.y<=m.position.y+h.height/m.zoomLevel+200}_process(){if(this.#f)if(o.pause)this.stop();else if(this.isVisible()){let i=m.position.x+h.width/2/m.zoomLevel,t=m.position.y+h.height/2/m.zoomLevel,e=Math.sqrt(Math.pow(this.position.x-i,2)+Math.pow(this.position.y-t,2)),s=500;if(e<s){let i=1-e/s;this.sound.volume=Math.max(0,Math.min(i,1))}else this.sound.volume=0,this.stop()}else this.sound.volume>0&&(this.sound.volume=Math.max(this.sound.volume-.01,0)),0===this.sound.volume&&this.#f&&this.stop()}}class Z{constructor(i,t){this.position=new e(i.x,i.y),this.vx=2*(Math.random()-.5),this.vy=2*(Math.random()-.5),this.life=100,this.size=3*Math.random()+1,this.color=t?`rgba(${t}, ${this.life/100})`:`rgba(255, 255, 255, ${this.life/100})`,this.visible=!0}_process(){o.pause||(this.position.x+=this.vx,this.position.y+=this.vy,this.life-=1)}Render(){a.beginPath(),a.arc(this.position.x,this.position.y,this.size,0,2*Math.PI),a.fillStyle=this.color,a.fill(),a.closePath()}isDead(){return this.life<=0}}class H{constructor(i=new e,t=1,s="white"){this.position=i,this.localPosition=i,this.visible=!0,this.particles=[],this.color=s,this.nomberParticles=t}emit(){if(this.visible&&!o.pause)for(let i=0;i<this.nomberParticles;i++)this.particles.push(new Z(this.position,this.color))}process(){o.pause||(this.particles=this.particles.filter((i=>!i.isDead())),this.particles.forEach((i=>i._process())))}Render(){this.particles.forEach((i=>{i.Render&&i.visible&&i.Render()}))}globalPosition(i=new e){this.position=i.add(this.localPosition)}}class Q extends U{constructor(i="undefined",t=new e,s=new e,o=0,n=[],r="undefined"){super(i,t,s),this.collision_layer=o,this.mask=Array.isArray(n)?n:Number.isInteger(n)?[n]:[0],this.color="rgba(0, 0, 230, 0.4)",this.type=r||"Trigger",this.visible=d,this.layer=10,this.borderLeft=this.position.x,this.borderRight=this.position.x+this.size.x,this.borderUp=this.position.y,this.borderDown=this.position.y+this.size.y}updateBorder(){this.borderLeft=this.position.x,this.borderRight=this.position.x+this.size.x,this.borderUp=this.position.y,this.borderDown=this.position.y+this.size.y}set_collision_mask(i){Number.isInteger(i)?(this.mask.forEach((t=>{if(i===t)return console.error(`La mascara ${i} ya existe en el objeto de colision ${this.name}\n`),void console.warn("El método set_collision_mask solo debe ser usado dentro de la función ready.")})),this.mask.push(mask)):console.error("El parametro en el metodo 'set_collision_mask' no es valido.")}Render(){a.fillStyle=this.color,a.fillRect(this.position.x,this.position.y,this.size.x,this.size.y),super.Render()}bodyEnter(i){return this.borderRight>=i.borderLeft&&this.borderLeft<=i.borderRight&&this.borderDown>=i.borderUp&&this.borderUp<=i.borderDown}}var ii=window;for(var ti in t)ii[ti]=t[ti];t.__esModule&&Object.defineProperty(ii,"__esModule",{value:!0})})();